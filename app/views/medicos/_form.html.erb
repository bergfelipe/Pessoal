<%= form_with(model: medico) do |form| %>
  <% if medico.errors.any? %>
    <div style="color: red">
      <h2><%= pluralize(medico.errors.count, "error") %> prohibited this medico from being saved:</h2>

      <ul>
        <% medico.errors.each do |error| %>
          <li><%= error.full_message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>
    <div class="row">
      <div class="col-lg-4 mb-4">
        <div class="card">
          <div class="card-body">
            <div class="d-flex flex-row gap-3">
              <div>
                <img src="/user-02.jpg" alt="user" class="rounded" width="100">
              </div>
              <div>
                <h3 class="fw-semibold mb-1">Dr. <%= medico.nome %></h3>
                <h6 class="text-muted fw-normal mb-2">Denstista</h6>
                <span class="badge bg-info-subtle text-success rounded fw-semibold">
                  Admin
                </span>
              </div>
            </div>
            <div class="row mt-4 pt-4">
              <div class="col text-center border-end">
                <h3 class="fw-semibold">14</h3>
                <h6 class="text-muted">Pacientes</h6>
              </div>
              <div class="col text-center border-end">
                <h3 class="fw-semibold">54</h3>
                <h6 class="text-muted">Consultas</h6>
              </div>
              <div class="col text-center">
                <h3 class="fw-semibold">145</h3>
                <h6 class="text-muted">Tasks</h6>
              </div>
              <button id="addConsultaBtn" class="btn btn-primary">Adicionar Consulta</button>
            </div>
          </div>
        </div>
        <div class="card">
          <h4 class="card-title px-9 py-4 mb-0">Pacientes do Dia</h4>
          <div class="card-body">
  
              <!-- ============================================================== -->
              <!-- Comment widgets -->
              <!-- ============================================================== -->
              <div class="comment-widgets position-relative mb-2 simplebar-scrollable-y" data-simplebar="init" style="height: 475px"><div class="simplebar-wrapper" style="margin: 0px;"><div class="simplebar-height-auto-observer-wrapper"><div class="simplebar-height-auto-observer"></div></div><div class="simplebar-mask"><div class="simplebar-offset" style="right: 0px; bottom: 0px;"><div class="simplebar-content-wrapper" tabindex="0" role="region" aria-label="scrollable content" style="height: 100%; overflow: hidden scroll;"><div class="simplebar-content" style="padding: 0px;">
                  <!-- Comment Row -->
                  <% @consulta.each do |f| %>
                  <div class="d-flex gap-9 comment-row mb-5">
                      <span class="flex-shrink-0"><img src="/user-09.jpeg" alt="user" width="56" height="56" class="rounded round-50"></span>
                      <div class="comment-text">
                          <div class="hstack justify-content-between gap-6 mb-1">
                              <div class="hstack gap-6">
                                  <h5 class="mb-0"> <%= f.paciente.nome  %></h5>
                                  <p class="mb-0 fs-3">daqui a 5 minutos</p>
                              </div>
                              <span class="badge bg-success-subtle text-success rounded fw-semibold p-2"><%=  formatar_data_hora_minuto(f.data_consulta) %></span>
                          </div>
                          <p class="comment-details mb-6 fs-3 text-muted truncate-2 truncate-2">
                            <%= f.paciente.ficha  %>
                          </p>
                          <ul class="list-unstyled mb-0 hstack gap-3 lh-1">
                              <li><a class="fs-6 text-muted" href="javascript:void(0)"><i class="ti ti-edit"></i></a></li>
                              <li><a class="fs-6 text-muted" href="javascript:void(0)"><i class="ti ti-square-check"></i></a></li>
                              <li><a class="fs-6 text-muted" href="javascript:void(0)"><i class="ti ti-heart"></i></a></li>
                          </ul>
                      </div>
                  </div>
                  <%end%>

              </div></div></div></div><div class="simplebar-placeholder" style="width: 574px; height: 624px;"></div></div><div class="simplebar-track simplebar-horizontal" style="visibility: hidden;"><div class="simplebar-scrollbar" style="width: 0px; display: none;"></div></div><div class="simplebar-track simplebar-vertical" style="visibility: visible;"><div class="simplebar-scrollbar" style="height: 361px; transform: translate3d(0px, 0px, 0px); display: block;"></div></div></div>
          </div>
      </div>
      </div>
      <div class="col-lg-8">
        <div id="consultas-container">
          <div class="card">
            <div class="card-body">
              <div class="row">
                <div class="col-md-4 mb-3">
                  <label class="form-label">Paciente</label>
                  <%= form.collection_select :pacientes_id, @pacientes, :id, :nome, { prompt: "Selecione um Paciente" }, { class: 'form-control', required:  'true'} %>
                </div>
                <div class="col-md-6 mb-3">
                  <label class="form-label">Data e hora da consulta</label>
                  <%= form.datetime_field :data_consulta,  { class: 'form-control', required:  'true'} %>
                </div>
                <div class="col-md-2 mt-4">
                  <button class="btn btn-danger remove-consulta-btn">
                    <i class="fas fa-trash"></i>
                  </button>
                </div>
              </div>
          <%= form.submit "Salvar", class: "btn btn-success " %>
            </div>
          </div>
        </div>
      </div>
    </div>
<% end %>


<script>
  document.addEventListener("DOMContentLoaded", function() {
  document.getElementById("addConsultaBtn").addEventListener("click", function() {
    var consultasContainer = document.getElementById("consultas-container");
  
    var card = document.createElement("div");
    card.className = "card";
  
    var cardBody = document.createElement("div");
    cardBody.className = "card-body";
  
    var row = document.createElement("div");
    row.className = "row";
  
    var pacienteCol = document.createElement("div");
    pacienteCol.className = "col-md-4 mb-3";
  
    var pacienteLabel = document.createElement("label");
    pacienteLabel.className = "form-label";
    pacienteLabel.textContent = "Paciente";
  
    var pacienteSelect = document.createElement("select");
    pacienteSelect.className = "form-control paciente-select";
    pacienteSelect.required = true;
    var defaultOption = document.createElement("option");
    defaultOption.value = "";
    defaultOption.disabled = true;
    defaultOption.selected = true;
    defaultOption.textContent = "Selecione um Paciente";
    pacienteSelect.appendChild(defaultOption);
  
    var dataCol = document.createElement("div");
    dataCol.className = "col-md-6 mb-3";
  
    var dataLabel = document.createElement("label");
    dataLabel.className = "form-label";
    dataLabel.textContent = "Data e hora da consulta";
  
    var dataInput = document.createElement("input");
    dataInput.type = "datetime-local";
    dataInput.className = "form-control data-consulta";
    dataInput.required = true;
  
    var removeCol = document.createElement("div");
    removeCol.className = "col-md-2 mb-3";
  
    var removeButton = document.createElement("button");
    removeButton.className = "btn btn-danger remove-consulta-btn";
    removeButton.textContent = "Remover";
  
    pacienteCol.appendChild(pacienteLabel);
    pacienteCol.appendChild(pacienteSelect);
    dataCol.appendChild(dataLabel);
    dataCol.appendChild(dataInput);
    removeCol.appendChild(removeButton);
  
    row.appendChild(pacienteCol);
    row.appendChild(dataCol);
    row.appendChild(removeCol);
  
    cardBody.appendChild(row);
    card.appendChild(cardBody);
  
    consultasContainer.appendChild(card);
  
    removeButton.addEventListener("click", function() {
        card.remove();
    });
  });
  });
  </script>