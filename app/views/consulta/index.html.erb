
<nav style="margin-left: 10px; size: 10px;" aria-label="breadcrumb" class="d-flex align-items-center">
  <ol class="breadcrumb d-flex align-items-center">
    <li class="breadcrumb-item">
      <a style="font-size: 15px;" class="text-decoration-none" href="home">Home
      </a>
    </li>
    <li class="breadcrumb-item">
      <a style="font-size: 15px; color: #04DFC0;" class="text-decoration-none" >Consultas
      </a>
    </li>
  </ol>
</nav>
<div class="card overflow-hidden chat-application">
  <div class="d-flex w-100">
    <div class="left-part border-end w-20 flex-shrink-0 d-none d-lg-block">
      <div class="container">
      <img
      src="https://img.freepik.com/vetores-gratis/ilustracao-do-conceito-de-equipe-de-profissionais-de-saude_114360-1608.jpg?t=st=1718921666~exp=1718925266~hmac=36bea393b14581f783e9854e5078b651bdef954b64e6b7ce1ab5109819b89389&w=826"
      alt="homepage"
      width="300"
      class="dark-logo"
    />
  </div>
      <div class="px-9 pt-4 pb-3">
      <%= button_to new_consultum_path, method: :get, class: "btn btn-success fw-semibold py-8 w-100", style: "background-color: #04DFC0;" do %>
      <i class="fas fa-plus-circle me-2"></i> Nova Consulta
    <% end %>
  </div>

      <ul class="list-group" style="height: calc(100vh - 400px)" data-simplebar="init"><div class="simplebar-wrapper" style="margin: 0px;"><div class="simplebar-height-auto-observer-wrapper"><div class="simplebar-height-auto-observer"></div></div><div class="simplebar-mask"><div class="simplebar-offset" style="right: 0px; bottom: 0px;"><div class="simplebar-content-wrapper" tabindex="0" role="region" aria-label="scrollable content" style="height: 100%; overflow: hidden;"><div class="simplebar-content" style="padding: 0px;">
        <li class="fw-semibold text-dark text-uppercase mx-9 my-2 px-3 fs-3">ATALHOS</li>
        <li class="list-group-item border-0 p-0 mx-9">
          <%= link_to consulta_path(q: { status_eq: Consultum.statuses[:ativa] }), class: 'd-flex align-items-center gap-6 list-group-item-action text-dark px-3 py-8 mb-1 rounded-1' do %>
            <i class="ti ti-calendar fs-6"></i>Consultas Ativas
          <% end %>
        </li>
        <li class="list-group-item border-0 p-0 mx-9">
          <%= link_to consulta_path(q: { status_eq: Consultum.statuses[:concluida] }), class: 'd-flex align-items-center gap-6 list-group-item-action text-dark px-3 py-8 mb-1 rounded-1' do %>
            <i class="ti ti-calendar-check fs-6"></i>Consultas Concluídas
          <% end %>
        </li>
        <li class="list-group-item border-0 p-0 mx-9">
          <%= link_to consulta_path(q: { status_eq: Consultum.statuses[:fechada] }), class: 'd-flex align-items-center gap-6 list-group-item-action text-dark px-3 py-8 mb-1 rounded-1' do %>
            <i class="ti ti-calendar-off fs-6"></i>Consultas Fechadas
          <% end %>
        </li>
        <li class="list-group-item border-0 p-0 mx-9">
          <%= link_to consulta_path(q: { status_eq: Consultum.statuses[:apagada] }), class: 'd-flex align-items-center gap-6 list-group-item-action text-dark px-3 py-8 mb-1 rounded-1' do %>
            <i class="ti ti-star fs-6"></i>Favoritas
          <% end %>
        </li>
          <%= search_form_for @q, url: consulta_path, method: :get, html: { id: 'search_form' } do |f| %>
        <li class="border-bottom my-3"></li>
        <li class="fw-semibold text-dark text-uppercase mx-9 my-2 px-3 fs-3">FILTRAR POR</li>
        <ul class="d-flex align-items-center">
          <% if current_admin.perfil == 'admin' %>
          <li class="list-group-item border-0 p-0 mx-9 fs-5">
            <%= f.hidden_field :medico_id_eq, id: "medico_id_field" %>
            <a href="#" data-bs-toggle="modal" data-bs-target="#medicoModal" class="gap-6 list-group-item-action text-dark px-3 py-8 mb-1 rounded-1">
              <img src="https://cdn-icons-png.flaticon.com/128/3762/3762767.png" width="40" height="40" class="mb-6 mx-auto" alt="">
              <h6>Médico</h6> 
            </a> 
          </li>
               <% end %>
          <li class="list-group-item border-0 p-0 mx-9 fs-5">
            <%= f.hidden_field :paciente_id_eq, id: "paciente_id_field" %>
            <a href="#" data-bs-toggle="modal" data-bs-target="#pacienteModal" class="gap-6 list-group-item-action text-dark px-3 py-8 mb-1 rounded-1">
              <img src="https://cdn-icons-png.flaticon.com/128/4228/4228708.png" width="40" height="40" class="mb-6 mx-auto" alt="">
              <h6>Paciente</h6> 
            </a>
          </li>

        </ul>
        
      </div></div></div></div><div class="simplebar-placeholder" style="width: 228px; height: 370px;"></div></div><div class="simplebar-track simplebar-horizontal" style="visibility: hidden;"><div class="simplebar-scrollbar" style="width: 0px; display: none;"></div></div><div class="simplebar-track simplebar-vertical" style="visibility: hidden;"><div class="simplebar-scrollbar" style="height: 0px; display: none;"></div></div></ul>
    </div>


     <!-- Modalmedico -->
  <div class="modal fade" id="pacienteModal" tabindex="-1" aria-labelledby="pacienteModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="pacienteModalLabel">Selecione um Paciente</h5>
          <div class="d-flex justify-content-end flex-grow-1">
            <%= link_to home_path, class: 'btn btn-primary btn-sm' do %>
              <i class="fas fa-eraser"></i> Limpar busca
            <% end %>
          </div>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="py-2">
            <ul class="list-style-none chat-list">
            <% @pacientes.each do |paciente| %>
              <li class="mb-4">
                <a href="javascript:void(0)">
                  <div href="#" class="select-paciente d-flex align-items-center" data-id="<%= paciente.id %>">
                    <img src="user-06.jpg" class="rounded round-50">
                    <div class="ms-3">
                      <h6 class="select-paciente" href="#" class="select-paciente" data-id="<%= paciente.id %>"><%= paciente.nome %></h6>
                      <small class="text-success">Online</small>
                    </div>
                  </div>
                </a>
              </li>
              <% end %>                        
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- Modal -->

    <!-- Modalmedico -->
  <div class="modal fade" id="medicoModal" tabindex="-1" aria-labelledby="medicoModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="medicoModalLabel">Selecione um Médico</h5>
          <div class="d-flex justify-content-end flex-grow-1">
            <%= link_to home_path, class: 'btn btn-primary btn-sm' do %>
              <i class="fas fa-eraser"></i> Limpar busca
            <% end %>
          </div>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="py-2">
            <ul class="list-style-none chat-list">
            <% @medicos.each do |medico| %>
              <li class="mb-4">
                <a href="javascript:void(0)">
                  <div href="#" class="select-medico d-flex align-items-center" data-id="<%= medico.id %>">
                    <img src="user-06.jpg" class="rounded round-50">
                    <div class="ms-3">
                      <h6 class="select-medico" href="#" class="select-medico" data-id="<%= medico.id %>"><%= medico.nome %></h6>
                      <small class="text-success">Online</small>
                    </div>
                  </div>
                </a>
              </li>
              <% end %>                        
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- Modal -->

    <div class="d-flex w-100">
      <div class="min-width-493">
        <div class="border-end user-chat-box h-100">
          <div class="px-4 pt-9 pb-6 d-none d-lg-block">
            <h4 class="card-title">Buscar por Data</h4>
            <div class="row">
              <div class="col-5">
                <label for="q_data_consulta_gteq">Data da Consulta (De)</label>
                <%= f.date_field :data_consulta_gteq, class: "form-control" %>
              </div>
              <div class="col-5">
                <label for="q_data_consulta_lteq">Data da Consulta (Até)</label>
                <%= f.date_field :data_consulta_lteq, class: "form-control" %>
              </div>
              <div class="col-2">
                <label >Ações</label>
                <%= button_tag(type: 'submit', class: 'btn btn-sm mt-1 fs-2', style: 'background-color: #04DFC0; color: white;') do %>
                  <i class="fas fa-search"></i> <!-- Adicione o ícone de busca aqui (Bootstrap Icons) -->
                <% end %>
                <%= link_to consulta_path, class: 'btn btn-primary btn-sm mt-1 fs-2' do %>
                <i class="fas fa-eraser"></i><!-- Adicione o ícone de busca aqui (Bootstrap Icons) -->
                <% end %>
              </div>
            </div>
          <% end %>
          

          
          

            
          </div>
          <div class="app-chat">
            <div class="d-flex align-items-center">
              <h3 class="px-9 py-4 mb-0">Consultas</h3>
              <span class="badge bg-info-subtle text-info rounded fw-semibold "> <i class="fas fa-info-circle me-1"></i>Selecione a Consulta que deseja detalhar</span>
          </div>
          
            <div class="card-header" style="background-color: white;">
              <table style="width: 100%;">
                <tr>
                  <td style="text-align: left;"><h6>Paciente</h6></td>
                  <td style="text-align: center;"><h6 style=" margin-left: -29px !important;">Data e Hora</h6></td>
                  <td style="text-align: right;"><h6>Médico</h6></td>
                </tr>
              </table>
            </div>
            
              <div class="card-body">

                <!-- ============================================================== -->
                <!-- Comment widgets -->
                <!-- ============================================================== -->
                <div class="comment-widgets position-relative mb-2 simplebar-scrollable-y" data-simplebar="init" style="height: 660px"><div class="simplebar-wrapper" style="margin: 0px;"><div class="simplebar-height-auto-observer-wrapper"><div class="simplebar-height-auto-observer"></div></div><div class="simplebar-mask"><div class="simplebar-offset" style="right: 0px; bottom: 0px;"><div class="simplebar-content-wrapper" tabindex="0" role="region" aria-label="scrollable content" style="height: 100%; overflow: hidden scroll;"><div class="simplebar-content" style="padding: 0px;">
                  <!-- Comment Row -->
                  <style>
                    #back-button:hover {
                      background-color: #e6e6e6 !important;
                      border-radius: 10px;
                    }
                  </style>
                  <% @consultas.each do |f| %>
                  <a id="back-button" href="<%= consulta_path(id: f.id) %>" style="text-decoration: none !important; display: block !important; transition: background-color 0.3s !important;">
                    <div class="d-flex gap-3 comment-row mb-5">
                      <span class="flex-shrink-0">
                        <div class="d-flex align-items-center gap-3 mb-4">
                          <h5 class="me-1"><%= f.id %></h5>
                          <img src="/user-05.jpg" alt="user" width="56" height="56" class="rounded round-50">
                          <h5><%= f.paciente.nome %></h5>
                        </div>
                      </span>
                      <div class="comment-text flex-grow-1 position-relative">
                        <div class="d-flex justify-content-between align-items-center mb-1 position-relative">
                          <div class="d-flex align-items-center gap-3">
                            <% if f.status == 'concluida' %>
                            <span class="badge bg-success-subtle text-success rounded fw-semibold p-2 date-center">
                              <%= formatar_data_hora_minuto(f.data_consulta) %>
                            </span>
                            <% elsif f.status == 'ativa' %>
                            <span class="badge bg-info-subtle text-info rounded fw-semibold p-2 date-center">
                              <%= formatar_data_hora_minuto(f.data_consulta) %>
                            </span>
                            <% elsif f.status == 'fechada' %>
                            <span class="badge bg-danger-subtle text-danger rounded fw-semibold p-2 date-center">
                              <%= formatar_data_hora_minuto(f.data_consulta) %>
                            </span>
                            <% elsif f.status == 'em_andamento' %>
                            <span class="badge bg-secondary-subtle text-secondary rounded fw-semibold p-2 date-center">
                              <%= formatar_data_hora_minuto(f.data_consulta) %>
                            </span>
                            <% end %>
                          </div>
                          <div class="d-flex align-items-center gap-3 mb-9">
                            <h5 class="mb-0">Dr.<%= f.medico.nome %></h5>
                            <img width="56" height="56" class="rounded round-50" src="/user-06.jpg" alt="user" data-bs-toggle="tooltip" data-bs-placement="top" title="" data-original-title="Priyanka">
                          </div>
                        </div>
                      </div>
                      <!-- Linha vertical -->
                      <div class="vertical-line"></div>
                    </div>
                  </a>
                <% end %>
                
  
                    
                </div></div></div></div><div class="simplebar-placeholder" style="width: 512px; height: 624px;"></div></div><div class="simplebar-track simplebar-horizontal" style="visibility: hidden;"><div class="simplebar-scrollbar" style="width: 0px; display: none;"></div></div><div class="simplebar-track simplebar-vertical" style="visibility: visible;"><div class="simplebar-scrollbar" style="height: 361px; transform: translate3d(0px, 0px, 0px); display: block;"></div></div></div>
              </div>
            </div>
        </div>
      </div>

          <div class="chat-box-inner-part h-100">
            <div class="chatting-box app-email-chatting-box">
              <div class="card-header py-3 border-bottom d-flex align-items-center">
                <h5 class="text-dark mb-0 fs-5 me-2">Detalhes da Consulta </h5> <h5 class="text-dark mb-0 fs-5"><%= @variavelnovadoid.id %></h5>
                <ul class="list-unstyled mb-0 d-flex ms-auto">
                  <% unless @variavelnovadoid.status == 'ativa' %> 
                  <li class="position-relative" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-title="Ativar">
                    <%= form_with url: ativar_consultum_path(@variavelnovadoid), method: :patch, class: 'd-inline confirmable-form' do %>
                      <button type="submit" class="d-block text-dark px-2 fs-5 bg-hover-primary nav-icon-hover position-relative z-index-5" style="border: none; background: none;" data-confirm-message="Tem certeza que deseja ativar a consulta?">
                        <i class="fas fa-vote-yea"></i>
                      </button>
                    <% end %>
                  </li>
                  <% else %>
                  <li class="position-relative" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-title="Fechar">
                    <%= form_with url: fechar_consultum_path(@variavelnovadoid), method: :patch, class: 'd-inline confirmable-form' do %>
                      <button type="submit" class="d-block text-dark px-2 fs-5 bg-hover-primary nav-icon-hover position-relative z-index-5" style="border: none; background: none;" data-confirm-message="Tem certeza que deseja fechar a consulta?">
                        <i class="fas fa-ban"></i>
                      </button>
                    <% end %>
                  </li>
                  <% end %>
                  <li class="position-relative" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-title="Apagar">
                    <%= form_with url: apagar_consultum_path(@variavelnovadoid), method: :patch, class: 'd-inline confirmable-form' do %>
                      <button type="submit" class="text-dark px-2 fs-5 bg-hover-primary nav-icon-hover position-relative z-index-5" style="border: none; background: none;" data-confirm-message="Tem certeza que deseja apagar a consulta?">
                        <i class="ti ti-trash"></i>
                      </button>
                    <% end %>
                  </li>
                </ul>
                
                
                
              </div>
              <script>
              document.addEventListener('DOMContentLoaded', function () {
  const confirmableForms = document.querySelectorAll('.confirmable-form');

  confirmableForms.forEach(form => {
    form.addEventListener('submit', function (e) {
      e.preventDefault(); // Prevent the form from submitting

      const confirmMessage = form.querySelector('button[type="submit"]').dataset.confirmMessage;

      Swal.fire({
        title: 'Você tem certeza?',
        text: confirmMessage,
        icon: 'warning',
        showCancelButton: true,
        confirmButtonColor: '#3085d6',
        cancelButtonColor: '#d33',
        cancelButtonText: 'Cancelar',
        confirmButtonText: 'Sim, faça isso!',
        customClass: {
          confirmButton: 'btn btn-success me-2', // Classe do botão de confirmação
          cancelButton: 'btn btn-primary'  // Classe do botão de cancelamento
        },
        buttonsStyling: false  // Permite o uso das classes personalizadas
      }).then((result) => {
        if (result.isConfirmed) {
          form.submit(); // Submit the form if confirmed
        }
      });
    });
  });
});


              </script>
              
              <br>
              <div class="container" style="max-width: 900px !important;">
                <div class="d-flex align-items-center">
                  <h5 class="me-2"><%= @variavelnovadoid.tipo %></h5>
                  <% if @variavelnovadoid.status == 'concluida' %>
                  <span class="badge bg-success-subtle text-success rounded fw-semibold mb-2 fs-3">
                    <%= @variavelnovadoid.status %>
                  </span>
                  <% elsif @variavelnovadoid.status == 'ativa' %>
                  <span class="badge bg-info-subtle text-info rounded fw-semibold mb-2 fs-3">
                    <%= @variavelnovadoid.status %>
                  </span>
                  <% elsif @variavelnovadoid.status == 'fechada' %>
                  <span class="badge bg-danger-subtle text-danger rounded fw-semibold mb-2 fs-3">
                    <%= @variavelnovadoid.status %>
                  </span>
                  <% elsif @variavelnovadoid.status == 'em_andamento' %>
                  <span class="badge bg-secondary-subtle text-secondary rounded fw-semibold mb-2 fs-3">
                    <%= @variavelnovadoid.status %>
                  </span>
                  <% end %>
                </div>
              <div class="card border-start border-top border-info">
                <div class="card-body">
                <div class="row">
              <div class="col-md-6">
                <div class="card text-center border-start border-top border-info" role="alert">
                  <div class="p-2 d-block mt-3">
                    <h5>Paciente</h5>
                    <img src="user-05.jpg" width="88" class="rounded-circle img-fluid">
                    <h5 class="card-title mt-3"><%= @variavelnovadoid.paciente.nome %></h5>
                  </div>
                </div>
              </div>
              <div class="col-md-6">
                <div class="card text-center border-start border-top border-info" role="alert">
                  <div class="p-2 d-block mt-3">
                    <h5>Médico</h5>
                    <img src="user-06.jpg" width="88" class="rounded-circle img-fluid">
                    <h5 class="card-title mt-3"><%= @variavelnovadoid.medico.nome %></h5>

                  </div>
                </div>
              </div>
            </div>
            <% consulta_time = @variavelnovadoid.data_consulta.strftime("%H:%M:%S") %>
            <% if (Time.parse(consulta_time) - Time.parse(@hoje)) <= 1.minute && @variavelnovadoid.status == 'ativa' %>
            <div class="row">
              <div class="col-12">
                <span class="badge bg-secondary-subtle text-danger rounded fw-semibold d-block mb-2">
                  <i class="fas fa-exclamation-circle me-1"></i> Atenção, Consulta no horário ou vencida, altere o status abaixo
                </span>
              </div>
              <div class="col-12">
                <%= form_with url: em_andamento_consultum_path(@variavelnovadoid), method: :patch, class: 'd-inline confirmable-form' do %>
                <button type="submit" class="btn btn-success btn-sm fs-3" 
                data-confirm-message="Tem certeza? A consulta ficará Em andamento">
                <i class="fas fa-check-circle me-1"></i>Começar Consulta
                </button>
              <% end %>
               <%= form_with url: fechar_consultum_path(@variavelnovadoid), method: :patch, class: 'd-inline confirmable-form' do %>
               <button type="submit" class="btn btn-danger btn-sm fs-3" 
               data-confirm-message="Tem certeza que deseja fechar a consulta?">
                   <i class="fas fa-times-circle me-1"></i> Fechar Consulta
                </button>
              <% end %>
              </div>
            </div>
          <% elsif @variavelnovadoid.status == 'em_andamento' %>
          <%= form_with url: concluida_consultum_path(@variavelnovadoid), method: :patch, class: 'd-inline confirmable-form' do %>
          <button type="submit" class="btn btn-secondary btn-sm fs-3" 
          data-confirm-message="Tem Certeza que deseja concluir a consulta?">
          <i class="fas fa-check-square me-1"></i>Finalizar Consulta
        </button>
          <br>
        <% end %>
          <% end %>
          <br>
            <div class="p-4 rounded-2 text-bg-light mb-3 border-start border-top border-info">
              <div class="d-flex align-items-center gap-6 flex-wrap">
                <h6 class="fw-semibold mb-0 fs-4">Ficha</h6>
                <span class="fs-2"><span class="p-1 text-bg-muted rounded-circle d-inline-block"></span> 
                <% if @variavelnovadoid.status == 'concluida' %>
                <span class="badge bg-success-subtle text-success rounded fw-semibold">
                  <%= formatar_data_hora_minuto( @variavelnovadoid.data_consulta) %>
                </span>
                <% elsif @variavelnovadoid.status == 'ativa' %>
                <span class="badge bg-info-subtle text-info rounded fw-semibold">
                  <%= formatar_data_hora_minuto( @variavelnovadoid.data_consulta) %>
                </span>
                <% elsif @variavelnovadoid.status == 'fechada' %>
                <span class="badge bg-danger-subtle text-danger rounded fw-semibold">
                  <%= formatar_data_hora_minuto( @variavelnovadoid.data_consulta) %>
                </span>
                <% end %>
              </span>
              </div>
              <p class="my-3" style="min-width: 802px !important; "><%= @variavelnovadoid.ficha %>
              </p>
            </div>
            <div class="d-flex align-items-center gap-6">
              <%= link_to edit_consultum_path(@variavelnovadoid), class: 'fs-5 text-muted' do %>
                <button class="btn btn-info fs-2" fdprocessedid="pk6kl8">
                  <i class="fas fa-edit"></i> Editar
                </button>
              <% end %>
              <%= link_to new_consultum_path(
                  paciente_id: @variavelnovadoid.paciente_id, 
                  medico_id: @variavelnovadoid.medico_id, 
                  tipo: @variavelnovadoid.tipo, 
                  status: @variavelnovadoid.status
                ), class: 'btn fs-2 me-5', fdprocessedid: '83zpb', style: "background-color: #04DFC0; color: white;" do %>
                <i class="fas fa-plus"></i> Nova Consulta a partir dessa
              <% end %>
            
              
              
            </div>
            <br>

            <div class="col-lg-12 ">
              <div class="card w-100">
                  <div class="d-flex justify-content-between px-9 py-9 border-bottom">
                      <div>
                          <h5 class="card-title">Atualizações</h5>
                          <div class="card-subtitle mb-0">Modificações na consulta</div>
                      </div>
                  </div>
                  <div class="card-body">
                    <ul class="feeds ps-0 mb-0">
                      <div class="feed-item mb-2 py-2 pe-4 pr-3">
                        <div class="
                            border-start border-2 border-info
                            d-md-flex
                            align-items-center
                          ">
                          <div class="d-flex align-items-center">
                            <a href="javascript:void(0)" class="
                                ms-3
                                btn bg-info-subtle
                                text-info
                                round-50
                                fs-5
                                d-flex
                                align-items-center
                                justify-content-center
                                flex-shrink-0
                              "> <i class="fas fa-edit"></i></a>
                            <div class="ms-3 text-truncate">
                              <span class="fw-normal h6">Consulta editada</span>
                            </div>
                          </div>
                          <div class="
                              justify-content-end
                              text-truncate
                              ms-5 ms-md-auto
                              ps-4 ps-md-0
                            ">
                            <span class="fs-3 text-muted">Agora</span>
                          </div>
                        </div>
                      </div>
                      <div class="feed-item mb-2 py-2 pe-4 pr-3">
                        <div class="
                            border-start border-2 border-danger
                            d-md-flex
                            align-items-center
                          ">
                          <div class="d-flex align-items-center">
                            <a href="javascript:void(0)" class="
                                ms-3
                                btn bg-danger-subtle
                                text-danger
                                round-50
                                fs-5
                                d-flex
                                align-items-center
                                justify-content-center
                                flex-shrink-0
                              "><i class="fas fa-ban"></i></a>
                            <div class="ms-3 text-truncate">
                              <span class="fw-normal h6">Consulta de Ativa para Fechada</span>
                            </div>
                          </div>
                          <div class="
                              justify-content-end
                              text-truncate
                              ms-5 ms-md-auto
                              ps-4 ps-md-0
                            ">
                            <span class="fs-3 text-muted">2 Horas atras</span>
                          </div>
                        </div>
                      </div>
                      <div class="feed-item mb-2 py-2 pe-4 pr-3">
                        <div class="
                            border-start border-2 border-success
                            d-md-flex
                            align-items-center
                          ">
                          <div class="d-flex align-items-center">
                            <a href="javascript:void(0)" class="
                                ms-3
                                btn bg-success-subtle
                                text-success
                                round-50
                                fs-5
                                d-flex
                                align-items-center
                                justify-content-center
                                flex-shrink-0
                              "><i class="fas fa-vote-yea"></i></a>
                            <div class="ms-3 text-truncate">
                              <span class="fw-normal h6">Consulta de Concluida para Ativa </span>
                            </div>
                          </div>
                          <div class="
                              justify-content-end
                              text-truncate
                              ms-5 ms-md-auto
                              ps-4 ps-md-0
                            ">
                            <span class="fs-3 text-muted">31 May</span>
                          </div>
                        </div>
                      </div>
                  
                    </ul>
                  </div>
              </div>
          </div>
              </div>
            </div>
          </div>
              </div>
            </div>

      </div>
    </div>
  </div>
</div>

<script>
  function openFichaModal(element) {
    var pacienteNome = element.getAttribute('data-consulta-paciente');
    var pacienteFicha = element.getAttribute('data-consulta-ficha');
    var consultaFicha = element.getAttribute('data-consulta-consulta-ficha');

    document.getElementById('modalPacienteNome').innerText = pacienteNome;
    document.getElementById('modalPacienteFicha').innerText = pacienteFicha;
    document.getElementById('modalConsultaFicha').innerText = consultaFicha;

    var fichaModal = new bootstrap.Modal(document.getElementById('fichaModal'));
    fichaModal.show();
  }

  document.addEventListener("DOMContentLoaded", function () {
    // Função para selecionar médicos
    document.querySelectorAll(".select-medico").forEach(function (element) {
      element.addEventListener("click", function (event) {
        event.preventDefault();
        var medicoId = this.getAttribute("data-id");
        var medicoNome = this.textContent;
        document.getElementById("medico_id_field").value = medicoId;
        var modal = bootstrap.Modal.getInstance(document.getElementById("medicoModal"));
        modal.hide();

        // Submit the form via AJAX
        document.getElementById('search_form').submit();
      });
    });

    // Função para selecionar pacientes
    document.querySelectorAll(".select-paciente").forEach(function (element) {
      element.addEventListener("click", function (event) {
        event.preventDefault();
        var pacienteId = this.getAttribute("data-id");
        var pacienteNome = this.textContent;
        document.getElementById("paciente_id_field").value = pacienteId;
        var modal = bootstrap.Modal.getInstance(document.getElementById("pacienteModal"));
        modal.hide();

        // Submit the form via AJAX
        document.getElementById('search_form').submit();
      });
    });

    // Remover manualmente o backdrop quando o modal é fechado
    var fichaModalElement = document.getElementById('fichaModal');
    fichaModalElement.addEventListener('hidden.bs.modal', function () {
      document.body.classList.remove('modal-open');
      var modals = document.querySelectorAll('.modal-backdrop');
      modals.forEach(function (modal) {
        modal.remove();
      });
    });

    // Função para reordenar a tabela
    const reorderButton = document.getElementById("reorder-button");
    const hiddenField = document.querySelector('input[name="q[s]"]');

    reorderButton.addEventListener("click", function() {
      if (hiddenField.value === 'created_at desc') {
        hiddenField.value = 'data_consulta asc';
      } else {
        hiddenField.value = 'created_at desc';
      }
      document.getElementById('search_form').submit();
    });
  });
</script>
              
                
<style>
  .comment-row {
    display: flex !important;
    align-items: flex-start !important;
    gap: 1rem !important;
    position: relative !important;
  }

  .comment-text {
    display: flex !important;
    flex-direction: column !important;
    width: 100% !important;
    position: relative !important;
  }

  .d-flex {
    display: flex !important;
  }

  .gap-3 {
    gap: 1rem !important;
  }

  .mb-1 {
    margin-bottom: 0.25rem !important;
  }

  .mb-5 {
    margin-bottom: 1.25rem !important;
  }

  .align-items-center {
    align-items: center !important;
  }

  .justify-content-between {
    justify-content: space-between !important;
  }

  .badge {
    display: inline-block !important;
    vertical-align: middle !important;
  }

  .truncate-2 {
    display: -webkit-box !important;
    -webkit-line-clamp: 2 !important;
    -webkit-box-orient: vertical !important;
    overflow: hidden !important;
  }

  .me-1 {
    margin-right: 0.25rem !important;
  }

  .vertical-line {
       position: absolute !important;
        left: 50% !important;
        top: 0 !important;
        bottom: -25px !important;
        border-left: 2px solid #ccc !important;
        transform: translateX(-50%) !important;
        z-index: -1 !important;
  }

  .date-center {
       position: absolute !important;
      left: 28% !important;
      transform: translateX(-50%) !important;
      white-space: nowrap !important;
  }
</style>


